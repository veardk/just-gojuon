(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[450],{3756:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});var n=t(4297);let s=(0,n.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5077:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});var n=t(4297);let s=(0,n.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},713:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});var n=t(4297);let s=(0,n.Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},116:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/practice/recognition/game",function(){return t(5553)}])},5553:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return game}});var n=t(5893),s=t(7294),r=t(1163),i=t(9008),c=t.n(i),l=t(9556),o=t(4148),d=t(4752),h=t(5817),u=t(4848),m=t(4297);let g=(0,m.Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);var x=t(3756),j=t(5077),k=t(713),p=t(6886),f=t(5231);let b={basic:p.IC[f.B.SEION].map(e=>({romaji:e.romaji,hiragana:e.hiragana,katakana:e.katakana})),dakuten:p.IC[f.B.DAKUON].map(e=>({romaji:e.romaji,hiragana:e.hiragana,katakana:e.katakana})),handakuten:p.IC[f.B.HANDAKUON].map(e=>({romaji:e.romaji,hiragana:e.hiragana,katakana:e.katakana})),yoon:p.IC[f.B.YOON].map(e=>({romaji:e.romaji,hiragana:e.hiragana,katakana:e.katakana}))};var game=()=>{let e=(0,r.useRouter)(),a=(0,l.ZK)(),[t,i]=(0,s.useState)(null),m=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!e.isReady)return;let{units:a,count:t,lang:n}=e.query;if(!a||!t){e.push("/practice/recognition");return}let s=a.split(","),r=parseInt(t),c=s.reduce((e,a)=>{let t=b[a];return t&&e.push(...t),e},[]);if(c.length<3){e.push("/practice/recognition");return}let l=generateQuestions(c,r);i({currentQuestion:0,totalQuestions:r,score:0,questions:l,selectedHiragana:null,selectedKatakana:null,isComplete:!1,startTime:Date.now(),endTime:null,isTransitioning:!1})},[e.isReady,e.query]),(0,s.useEffect)(()=>()=>{m.current&&clearTimeout(m.current)},[]);let generateQuestions=(e,a)=>{let t=[];for(let n=0;n<a;n++){let a=e[Math.floor(Math.random()*e.length)],n=[a.hiragana];for(;n.length<3;){let a=e[Math.floor(Math.random()*e.length)];n.includes(a.hiragana)||n.push(a.hiragana)}let s=[a.katakana];for(;s.length<3;){let a=e[Math.floor(Math.random()*e.length)];s.includes(a.katakana)||s.push(a.katakana)}shuffleArray(n),shuffleArray(s),t.push({romaji:a.romaji,correctHiragana:a.hiragana,correctKatakana:a.katakana,hiraganaOptions:n,katakanaOptions:s})}return t},shuffleArray=e=>{for(let a=e.length-1;a>0;a--){let t=Math.floor(Math.random()*(a+1));[e[a],e[t]]=[e[t],e[a]]}},handleSelection=(e,a)=>{if(!t||t.isTransitioning)return;let n=t.questions[t.currentQuestion];i(t=>{if(!t||t.isTransitioning)return t;let s={...t,["hiragana"===e?"selectedHiragana":"selectedKatakana"]:a};if(s.selectedHiragana&&s.selectedKatakana){s.isTransitioning=!0;let e=s.selectedHiragana===n.correctHiragana,a=s.selectedKatakana===n.correctKatakana;m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{i(t=>{if(!t)return t;let n=t.currentQuestion+1,s=t.score;return(e&&a&&(s+=1),n>=t.totalQuestions)?{...t,score:s,isComplete:!0,endTime:Date.now(),isTransitioning:!1}:{...t,score:s,currentQuestion:n,selectedHiragana:null,selectedKatakana:null,isTransitioning:!1}}),m.current=null},1e3)}return s})};if(!t)return(0,n.jsx)(o.Z,{children:(0,n.jsx)(d.Z,{className:"py-8",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-japanese-hiragana mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-text-secondary",children:"zh"===a?"正在加载游戏...":"Loading game..."})]})})});let p=t.questions[t.currentQuestion],f=(t.currentQuestion+1)/t.totalQuestions*100;return(0,n.jsxs)(o.Z,{children:[(0,n.jsx)(c(),{children:(0,n.jsx)("title",{children:"zh"===a?"识别训练游戏 - Just Gojuon":"Recognition Game - Just Gojuon"})}),(0,n.jsx)(d.Z,{className:"py-8",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto",children:t.isComplete?(0,n.jsx)(h.Z,{className:"text-center",children:(0,n.jsxs)("div",{className:"py-12",children:[(0,n.jsx)(x.Z,{className:"w-16 h-16 text-semantic-success mx-auto mb-6"}),(0,n.jsx)("h2",{className:"text-3xl font-bold text-text-primary mb-4",children:"zh"===a?"练习完成！":"Practice Complete!"}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 mb-8 max-w-md mx-auto",children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-2xl font-bold text-japanese-hiragana",children:t.score}),(0,n.jsx)("div",{className:"text-sm text-text-secondary",children:"zh"===a?"正确题数":"Correct"})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"text-2xl font-bold text-japanese-katakana",children:[Math.round(t.score/t.totalQuestions*100),"%"]}),(0,n.jsx)("div",{className:"text-sm text-text-secondary",children:"zh"===a?"准确率":"Accuracy"})]})]}),t.endTime&&(0,n.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,n.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-text-secondary",children:[(0,n.jsx)(j.Z,{className:"w-4 h-4"}),"zh"===a?"用时":"Time",": ",Math.round((t.endTime-t.startTime)/1e3),"s"]})})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,n.jsxs)(u.Z,{onClick:()=>{if(!t)return;let e=generateQuestions(t.questions.map(e=>({romaji:e.romaji,hiragana:e.correctHiragana,katakana:e.correctKatakana})),t.totalQuestions);i({...t,currentQuestion:0,score:0,questions:e,selectedHiragana:null,selectedKatakana:null,isComplete:!1,startTime:Date.now(),endTime:null,isTransitioning:!1})},className:"bg-japanese-hiragana hover:bg-japanese-hiragana/90",children:[(0,n.jsx)(k.Z,{className:"w-5 h-5 mr-2"}),"zh"===a?"再次练习":"Practice Again"]}),(0,n.jsx)(u.Z,{variant:"outline",onClick:()=>e.push("/practice/recognition"),children:"zh"===a?"返回设置":"Back to Settings"}),(0,n.jsx)(u.Z,{variant:"outline",onClick:()=>e.push("/"),children:"zh"===a?"返回首页":"Back to Home"})]})]})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("div",{className:"flex items-center gap-4",children:(0,n.jsxs)(u.Z,{variant:"outline",size:"sm",onClick:()=>e.push("/practice/recognition"),children:[(0,n.jsx)(g,{className:"w-4 h-4 mr-2"}),"zh"===a?"返回":"Back"]})}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsxs)("div",{className:"text-sm text-text-secondary",children:["zh"===a?"题目":"Question"," ",t.currentQuestion+1," / ",t.totalQuestions]}),(0,n.jsxs)("div",{className:"text-sm text-text-secondary",children:["zh"===a?"得分":"Score",": ",t.score]})]})]}),(0,n.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,n.jsx)("div",{className:"bg-japanese-hiragana h-2 rounded-full transition-all duration-300",style:{width:"".concat(f,"%")}})})]}),(0,n.jsx)(h.Z,{className:"mb-8 text-center bg-gradient-to-r from-japanese-hiragana/5 to-japanese-katakana/5",children:(0,n.jsxs)("div",{className:"py-12",children:[(0,n.jsx)("h2",{className:"text-sm text-text-secondary mb-4",children:"zh"===a?"请选择对应的假名":"Select the corresponding kana"}),(0,n.jsx)("div",{className:"text-6xl font-mono font-bold text-text-primary mb-8",children:p.romaji})]})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,n.jsxs)(h.Z,{className:"p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-japanese-hiragana mb-4 text-center",children:"zh"===a?"平假名":"Hiragana"}),(0,n.jsx)("div",{className:"grid grid-cols-3 gap-3",children:p.hiraganaOptions.map((e,a)=>{let s=t.selectedHiragana===e,r=e===p.correctHiragana,i=t.selectedHiragana&&t.selectedKatakana;return(0,n.jsx)("button",{onClick:()=>handleSelection("hiragana",e),disabled:null!==t.selectedHiragana||t.isTransitioning,className:"\n                            h-16 text-2xl font-japanese rounded-lg border-2 transition-all\n                            ".concat(s&&i&&r?"bg-semantic-success text-white border-semantic-success":"","\n                            ").concat(s&&i&&!r?"bg-semantic-error text-white border-semantic-error":"","\n                            ").concat(!s&&i&&r?"bg-semantic-success/20 border-semantic-success":"","\n                            ").concat(s&&!i?"bg-japanese-hiragana/20 border-japanese-hiragana":"","\n                            ").concat(s||i?"":"bg-white border-gray-300 hover:border-japanese-hiragana hover:bg-japanese-hiragana/10","\n                            disabled:cursor-not-allowed\n                          "),children:e},a)})})]}),(0,n.jsxs)(h.Z,{className:"p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-japanese-katakana mb-4 text-center",children:"zh"===a?"片假名":"Katakana"}),(0,n.jsx)("div",{className:"grid grid-cols-3 gap-3",children:p.katakanaOptions.map((e,a)=>{let s=t.selectedKatakana===e,r=e===p.correctKatakana,i=t.selectedHiragana&&t.selectedKatakana;return(0,n.jsx)("button",{onClick:()=>handleSelection("katakana",e),disabled:null!==t.selectedKatakana||t.isTransitioning,className:"\n                            h-16 text-2xl font-japanese rounded-lg border-2 transition-all\n                            ".concat(s&&i&&r?"bg-semantic-success text-white border-semantic-success":"","\n                            ").concat(s&&i&&!r?"bg-semantic-error text-white border-semantic-error":"","\n                            ").concat(!s&&i&&r?"bg-semantic-success/20 border-semantic-success":"","\n                            ").concat(s&&!i?"bg-japanese-katakana/20 border-japanese-katakana":"","\n                            ").concat(s||i?"":"bg-white border-gray-300 hover:border-japanese-katakana hover:bg-japanese-katakana/10","\n                            disabled:cursor-not-allowed\n                          "),children:e},a)})})]})]})]})})})]})}}},function(e){e.O(0,[372,886,774,888,179],function(){return e(e.s=116)}),_N_E=e.O()}]);